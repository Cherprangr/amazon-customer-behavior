---
title: "Amazon_Customer Behaviour"
format: html
editor: visual
---

```{r}
rm(list = ls())
```

**The Amazon Customer Behavior Survey Data set** \
This data set offers

```{r}
library(readxl)
data <- read_excel("/Users/jeans/Documents/Econometrics/Empirical Project/Amazon Customer Behavior Survey.xlsx")
```

```{r}
# DV: Already numeric
data$Shopping_Satisfaction <- as.numeric(data$Shopping_Satisfaction)

data$Personalized_Recommendation_Frequency <- as.numeric(as.character(factor(
  data$Personalized_Recommendation_Frequency, 
  levels = c("No", "Sometimes", "Yes"),
  labels = c(0, 1, 2)
)))

data$Recommendation_Helpfulness <- as.numeric(as.character(factor(
  data$Recommendation_Helpfulness,
  levels = c("No", "Sometimes", "Yes"),
  labels = c(0, 1, 2)
)))

data$Purchase_Frequency <- as.numeric(as.character(factor(
  data$Purchase_Frequency,
  levels = c("Less than once a month", "Once a month", "Few times a month", "Once a week", "Multiple times a week"),
  labels = c(1, 2, 3, 4, 5)
)))

data$Search_Result_Exploration <- as.numeric(as.character(factor(
  data$Search_Result_Exploration,
  levels = c("First page", "Multiple pages"),
  labels = c(1, 0)
)))
#View(data)
```

```{r}
library(stargazer)
model <- lm(Shopping_Satisfaction ~ Purchase_Frequency + Recommendation_Helpfulness+ Personalized_Recommendation_Frequency+ Search_Result_Exploration, data=data)
stargazer(model, type = "text", title = "Amazon_Personalized Recommendation", align = TRUE)
```

```{r}
model2 <- lm(Shopping_Satisfaction ~ Purchase_Frequency + Recommendation_Helpfulness+ Personalized_Recommendation_Frequency+ Search_Result_Exploration+Recommendation_Helpfulness* Search_Result_Exploration, data=data)
stargazer(model2, type = "text", title = "Amazon_Interaction Term", align = TRUE)

```

```{r}
# Step 1: Log-transform Purchase Frequency
data$log_Purchase_Frequency <- log(data$Purchase_Frequency)

# Step 2: Re-run your regression model with the log-transformed variable
model3_log <- lm(Shopping_Satisfaction ~ log_Purchase_Frequency + 
                   Recommendation_Helpfulness + 
                   Personalized_Recommendation_Frequency + 
                   Search_Result_Exploration + 
                   Recommendation_Helpfulness * Search_Result_Exploration, 
                 data = data)

# Step 3: Output your regression result
library(stargazer)
stargazer(model3_log, type = "text", title = "Amazon Shopping Satisfaction Model", align = TRUE)
```

```{r}
# Step 1: Load the necessary package
library(car)

# Step 2: Run VIF on your regression model
vif(model3_log)

```

```{r}
# Create a tidy data frame of VIF results
vif_table <- as.data.frame(vif(model3_log, type = "predictor"))
vif_table$Variable <- rownames(vif_table)
rownames(vif_table) <- NULL

# Reorder columns
vif_table <- vif_table[, c("Variable", "GVIF")]

# Print or view
print(vif_table)
#View(vif_table)

```

```{r}
# Run full GVIF including interaction terms
vif(model3_log)

```

```{}
```
